<% content_for :title, "#{@book.title} - 編集" %>

<div class="edit-book-container">
    <div class="back-navigation">
        <%= link_to @book, class: "back-button" do %>
        ← 戻る
        <% end %>
    </div>

    <div class="edit-card">
        <h1 class="page-title">本を編集</h1>

        <%= form_with model: @book, local: true, class: "book-form" do |form| %>
        <% if @book.errors.any? %>
        <div class="error-messages">
            <ul>
                <% @book.errors.full_messages.each do |message| %>
                <li><%= message %></li>
                <% end %>
            </ul>
        </div>
        <% end %>

        <div class="form-group">
            <%= form.label :title, "タイトル", class: "form-label" %>
            <%= form.text_field :title, required: true, class: "form-input" %>
        </div>

        <div class="form-group">
            <%= form.label :author, "著者", class: "form-label" %>
            <%= form.text_field :author, class: "form-input" %>
        </div>

        <div class="form-group">
            <%= form.label :publisher, "出版社", class: "form-label" %>
            <%= form.text_field :publisher, class: "form-input" %>
        </div>

        <div class="form-group">
            <%= form.label :cover_image_url, "表紙画像URL", class: "form-label" %>
            <%= form.url_field :cover_image_url, class: "form-input" %>
            <% if @book.cover_image_url.present? %>
            <div class="current-image-preview">
                <p>現在の画像:</p>
                <img src="<%= @book.cover_image_url %>" alt="<%= @book.title %>" class="preview-image">
            </div>
            <% end %>
        </div>

        <div class="form-group">
            <%= form.label :rating, "評価", class: "form-label" %>
            <%= form.select :rating, options_for_select([
              ['未評価', nil],
              ['★☆☆☆☆ (1)', 1],
              ['★★☆☆☆ (2)', 2],
              ['★★★☆☆ (3)', 3],
              ['★★★★☆ (4)', 4],
              ['★★★★★ (5)', 5]
        ], @book.rating), {}, { class: "form-select" } %>
        </div>

        <div class="form-group">
            <%= form.label :memo, "メモ・感想", class: "form-label" %>
            <%= form.text_area :memo, rows: 6, placeholder: "読んだ感想や印象に残った部分を記録しましょう", class: "form-textarea" %>
        </div>

        <div class="form-actions">
            <%= form.submit "更新", class: "submit-button primary" %>
            <%= link_to "キャンセル", @book, class: "submit-button secondary" %>
        </div>
        <% end %>
    </div>
</div>